<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ê¹€ì„ ê²½ - ê³„ì¢Œ ì°¾ê¸°</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable.css" />
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Pretendard Variable', sans-serif;
    }
    html, body {
      color: #222;
      background: #f4f6f8;
      font-size: 14px;
    }
    .title {
      text-align: center;
    }
    #container {
      max-width: 500px;
      margin: 60px auto;
      padding: 32px 20px;
      border: 1px solid #e5e7eb;
      border-radius: 10px;
      background-color: #fff;
      box-shadow: 0 1px 4px rgba(0,0,0,0.06);
    }
    input {
      cursor: pointer;
      outline: none;
    }
    input[type="text"] {
      width: 100%;
      padding: 8px;
      border: 1px solid #d1d5db;
      font-size: 16px;
      color: #111827;
      background-color: #f8fafc;
      border-radius: 5px;
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }
    input[type="text"]:focus {
      border-color: #2f80ed;
      box-shadow: 0 0 0 3px rgba(47, 128, 237, 0.2);
    }
    input[type="text"]::placeholder {color: #ccc;}
    .btn {
      padding: 10px 20px;
      border: none;
      color: white;
      font-weight: bold;
      border-radius: 5px;
      cursor: pointer;
      background-color: #222;
      transition: opacity 0.3s ease;
    }
    .btn-deposit {background-color: #27ae60;}
    .btn-withdraw {background-color: #f2994a;}
    .btn-close {background-color: #eb5757;}
    .btn:hover {opacity: 0.75;}
    .btn:disabled {
      background-color: #cfd8e3;
      color: #fff;
      cursor: not-allowed;
      opacity: 0.6;
    }
    .account {margin-top: 50px;}
    .srch {
      display: flex;
      gap: 0;
    }
    .srch input[type="text"] {
      border-top-right-radius: 0;
      border-bottom-right-radius: 0;
      flex: 1;
    }
    .srch .btn {
      border-top-left-radius: 0;
      border-bottom-left-radius: 0;
    }
    .total {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: 20px;
      padding: 10px;
      border-radius: 5px;
      background-color: #f0f4f8;
      font-size: 16px;
    }
    .total dt {color: #444;}
    .total dd {
      font-weight: bold;
      color: #2f80ed;
    }
    .list {
      display: flex;
      flex-direction: column;
      gap: 15px;
      padding: 20px;
      margin-top: 10px;
      border-radius: 5px;
      background-color: #eaeaea;
    }
    .list .alert-txt {
      text-align: center;
      font-size: 12px;
      color: #696969;
    }
    .list li {
      display: flex;
      align-items: flex-start;
      gap: 14px;
      padding: 16px 20px;
      list-style: none;
      border-radius: 12px;
      background-color: #fff;
      border: 2px solid #fff;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
      transition: transform 0.2s ease;
    }
    .list li:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
    }
    .list li.active {
      border: 2px solid #2f80ed;
    }
    .ac-list {
      display: flex;
      align-items: flex-start;
      gap: 14px;
      width: 100%;
    }
    .ac-list input[type="radio"] {
      margin-top: 4px;
      accent-color: #2f80ed;
      width: 18px;
      height: 18px;
      flex-shrink: 0;
    }
    .ac-list label {
      flex: 1;
      cursor: pointer;
    }
    .ac-list dl {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    .ac-list dt {
      width: 80px;
      color: #888;
      font-weight: 500;
    }
    .ac-list dd {
      width: calc(100% - 80px - 10px);
      color: #222;
      font-weight: 700;
    }
    .btn-wrap {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: center;
      gap: 10px;
      margin-top: 20px;
    }
    .btn-wrap .btn {flex: 1 1 30%;}
  </style>
</head>
<body>
  <div id="wrap">
    <main id="container">
      <h1 class="title">ğŸ’° ê³„ì¢Œ ì°¾ê¸° ğŸ’°</h1>
      <div class="account">
        <!-- ê²€ìƒ‰ -->
        <div class="srch">
          <input type="text" id="ipt-srchName" name="ipt-srchName" onkeydown="enterKey(event);" placeholder="ì´ë¦„" />
          <button type="button" class="btn" onclick="search();">ê²€ìƒ‰</button>
        </div>

        <!-- ì´ì•¡ -->
        <dl class="total">
          <dt>ì´ì•¡</dt>
          <dd id="acc-total"></dd>
        </dl>

        <!-- ê²°ê³¼ ë¦¬ìŠ¤íŠ¸ -->
        <div class="list" id="list">
          <ul>
            <!-- innerHTML js -->
          </ul>
        </div>
        
        <!-- ë²„íŠ¼ -->
        <div class="btn-wrap">
          <button type="button" class="btn btn-deposit" onclick="depositAccount();" id="btn-deposit" disabled>ì…ê¸ˆ</button>
          <button type="button" class="btn btn-withdraw" onclick="withdrawAccount();" id="btn-withdraw" disabled>ì¶œê¸ˆ</button>
          <button type="button" class="btn btn-close" onclick="closeAccount();" id="btn-close" disabled>í•´ì§€</button>
        </div>
      </div>
    </main>
  </div>
</body>

<script>
// í´ë˜ìŠ¤ ìƒì„±
class Account {
  constructor (ì´ë¦„, íƒ€ì…, ì”ì•¡) {
    this.name = ì´ë¦„;
    this.type = íƒ€ì…;
    this.balance = ì”ì•¡;
  }
}

// ì‚¬ìš©ì ê³„ì¢Œì •ë³´
const account = [
  new Account('ê¹€ì² ìˆ˜', 'ì˜ˆê¸ˆ', 100000),
  new Account('ê¹€ì² ìˆ˜', 'ì˜ˆê¸ˆ', 3000000),
  new Account('ê¹€ì² ìˆ˜', 'ì ê¸ˆ', 200000),
  new Account('í™ê¸¸ë™', 'ì˜ˆê¸ˆ', 400000),
  new Account('í™ê¸¸ë™', 'ì˜ˆê¸ˆ', 1000),
  new Account('í™ê¸¸ë™', 'ì ê¸ˆ', 10000000),
  new Account('ì´ë¯¸ë‚˜', 'ì˜ˆê¸ˆ', 30000),
  new Account('ì´ë¯¸ë‚˜', 'ì˜ˆê¸ˆ', 20000),
  new Account('ì´ë¯¸ë‚˜', 'ì ê¸ˆ', 50000),
];
console.log('ì „ì²´ ì–´ì¹´ìš´íŠ¸', account);

// ê²€ìƒ‰
const input = document.querySelector('#ipt-srchName');
function search() {
  input.value = input.value.replace(/[^ê°€-í£]/g, "");
  if (input.value.trim().length === 0) {
    alert('ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
    input.focus();
  } else {
    renderAccountList();
  }
}

// ì´í•©
const balanceTotal = document.querySelector('#acc-total');

// ë²„íŠ¼ í´ë¦­ ìœ ë¬´ ì²´í¬
let hasChk = false; 

// ê²€ìƒ‰ í›„ ë¦¬ìŠ¤íŠ¸ ë„ìš°ê¸°
function renderAccountList() {
  const list = document.querySelector('.list');
  let tempHTML = ''; // ì„ì‹œ ë³€ìˆ˜
  let sum = 0;
  let hasResult = false;

  // ë¦¬ìŠ¤íŠ¸ ë¦¬ì…‹
  list.innerHTML = '';

  // ë¦¬ìŠ¤íŠ¸ ì„ì‹œë³€ìˆ˜ì— ë‹´ì•„ë†“ê¸°
  account.forEach((item, idx) => {
    if (input.value.trim() === item.name) {
      hasResult = true;
      tempHTML += `
        <li>
          <div class="ac-list">
            <input type="radio" id="acc-${idx}" name="acc" onclick="statusBtn(this)"/>
            <label for="acc-${idx}">
              <dl>
                <dt>ì´ë¦„</dt>
                <dd>${item.name}</dd>
                <dt>ì˜ˆê¸ˆ íƒ€ì…</dt>
                <dd>${item.type}</dd>
                <dt>ì”ì•¡</dt>
                <dd>${item.balance.toLocaleString()}</dd>
              </dl>
            </label>
          </div>
        </li>
      `;
      sum += item.balance;
    }
  });

  // ë¦¬ìŠ¤íŠ¸ ë¿Œë¦¬ê¸°
  list.innerHTML = tempHTML;
  
  const btns = document.querySelectorAll('.btn-wrap .btn');
  btns.forEach((item) => {
    item.disabled = true;
    hasChk = false;
  });

  if (!hasResult) {
    sum = 0;
    document.querySelector('#acc-total').textContent = '';
    document.querySelector('.list').innerHTML = `<p class="alert-txt">ì¼ì¹˜í•˜ëŠ” ê³„ì¢Œê°€ ì—†ìŠµë‹ˆë‹¤.</p>`;
    input.focus();
    return;
  } 

  // ì´ì•¡ , ì²˜ë¦¬
  balanceTotal.textContent = sum.toLocaleString();
}

// ë²„íŠ¼ ì œì–´
function statusBtn(target) {
  const li = document.querySelectorAll('.list li');
  li.forEach((item) => item.classList.remove('active'));
  target.closest('li').classList.add('active');

  const id = Number(target.id.split('-')[1]);
  
  if (!hasChk) {
    document.querySelector('#btn-deposit').disabled = false;
    hasChk = true;
  }

  if (account[id].type === 'ì ê¸ˆ') {
    document.querySelector('#btn-close').disabled = false;
    document.querySelector('#btn-withdraw').disabled = true;
  } else {
    document.querySelector('#btn-close').disabled = true; 
    document.querySelector('#btn-withdraw').disabled = false; 
  }
}

// ì…/ì¶œ/ì  ê³µí†µ
function handleComm(callback) {
  const chkBox = document.querySelectorAll('input[name="acc"]:checked');
  if (chkBox.length === 0) {
    alert('ë¦¬ìŠ¤íŠ¸ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
    return;
  }

  chkBox.forEach((item) => {
    const id = Number(item.id.split('-')[1]);
    const acc = account[id];
    callback(acc, id);
  });
}

// ì…/ì¶œê¸ˆ prompt alert common
let promptValue; 
function alertComm(action) {
  promptValue = prompt(`${action} ê¸ˆì•¡ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.`);

  if (promptValue === null) {
    alert(`${action}ì„ ì·¨ì†Œí•˜ì˜€ìŠµë‹ˆë‹¤.`);
    return;
  } else if (promptValue.trim() === '') {
    alert(`ê¸ˆì•¡ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.`);
    return;
  } 

  if (isNaN(promptValue)) {
    alert('ìˆ«ìë§Œ ì…ë ¥ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
    return;
  }
}

// ì…ê¸ˆ
function depositAccount() {
  handleComm((acc, id) => {
    alertComm('ì…ê¸ˆ');

    if (Number(promptValue) > 1000000) {
      alert('ì…ê¸ˆ í•œë„ëŠ” 1,000,000ì›ê¹Œì§€ ì…ë‹ˆë‹¤.');
      return;
    } else if (Number(promptValue <= 1000000)) {
      acc.balance += Number(promptValue);
      renderAccountList();
    }
  });

  console.log('account',account);
}

// ì¶œê¸ˆ
function withdrawAccount() {
  handleComm((acc, id) => {
    alertComm('ì¶œê¸ˆ');

    if (Number(promptValue) <= acc.balance) { // ì…ë ¥ ê¸ˆì•¡ì´ ë³´ìœ  ê¸ˆì•¡ë³´ë‹¤ ê°™ê±°ë‚˜ ì ì€ ê²½ìš°
      acc.balance -= Number(promptValue);
      renderAccountList();
    } else if (Number(promptValue) > 1000000) { // ì…ë ¥ ê¸ˆì•¡ì´ 100ë§Œì›ë³´ë‹¤ ë§ì€ ê²½ìš°
      alert('ì¶œê¸ˆ í•œë„ëŠ” 1,000,000ì›ê¹Œì§€ ì…ë‹ˆë‹¤.');
      return;
    } else if (Number(promptValue) > acc.balance) { // ì…ë ¥ ê¸ˆì•¡ì´ ë³´ìœ  ê¸ˆì•¡ë³´ë‹¤ ë§ì€ ê²½ìš°
      alert(`ì”ì•¡ì´ ë¶€ì¡±í•©ë‹ˆë‹¤. í˜„ì¬ ì”ì•¡ : ${acc.balance.toLocaleString()}ì›`);
      return;
    }

    console.log('account',account);
  });
}

// í•´ì§€
function closeAccount() {
  handleComm((acc, id) => {
    const isTrue = confirm('ì´ ê³„ì¢Œë¥¼ í•´ì§€í•˜ì‹œê² ìŠµë‹ˆê¹Œ?');
    if (isTrue) {
      account.splice(id, 1);
    } else {
      alert('í•´ì§€ë¥¼ ì·¨ì†Œí•˜ì…¨ìŠµë‹ˆë‹¤.')
    }
    renderAccountList();
  });

  console.log('account',account);
}

const enterKey = (e) => {
  if (e.key === 'Enter') {
    e.preventDefault();
    search();
  }
}
</script>
</html>